---
  - hosts: all
    tasks:
      - name: 'windows : install SNMP'
        win_dsc:
          resource_name: "{{ snmp_resource_name }}"
          Name: "{{ snmp_name }}"
          Ensure: "{{ snmp_present }}"

      - name: Replace SNMP communities and managers
        win_snmp:
          communities:
            - MySnMPStr!ng
          managers:
            - 192.168.1.2
          action: set

      - name: Replace SNMP communities and clear managers
        win_snmp:
          communities:
            - public
          managers: []
          action: set
